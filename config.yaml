# Home Assistant Add-on Configuration
# https://developers.home-assistant.io/docs/add-ons/configuration

name: "Dumio Agent"
description: "Agente inteligente para Home Assistant con comunicación WebSocket y soporte cloud"
version: "1.2.0"
slug: "dumio_agent"
url: "https://github.com/DumioHome/dumio-agent"

# NOTE: Para usar imágenes pre-construidas de Docker Hub, descomentar la siguiente línea:
# image: "juaniimelodev/dumio-agent-{arch}"
# Sin esta línea, Home Assistant construirá la imagen localmente desde el Dockerfile

# Supported architectures
arch:
  - amd64
  - aarch64
  - armv7

# System configuration
init: false
homeassistant_api: true
hassio_api: true
auth_api: true

# Startup configuration
startup: services
boot: auto

# Watchdog - restart addon if it crashes or becomes unresponsive
watchdog: "http://[HOST]:[PORT:8099]/health"

# Ingress - enables web access through Home Assistant UI
ingress: true
ingress_port: 3000
ingress_stream: false
panel_icon: "mdi:robot"
panel_title: "Dumio Agent"

# Options available to the user
options:
  dumio_device_id: ""
  log_level: info
  reconnect_interval: 5000
  max_reconnect_attempts: 10
  cloud_socket_url: ""
  cloud_api_key: ""
  enable_api: true

# Schema for options validation
schema:
  dumio_device_id: str?
  log_level: list(trace|debug|info|warn|error|fatal)
  reconnect_interval: int(1000,60000)
  max_reconnect_attempts: int(1,100)
  cloud_socket_url: str?
  cloud_api_key: password?
  enable_api: bool

# Ports (for API access - external access for tools like Bruno/Postman)
ports:
  "3000/tcp": 3000
ports_description:
  "3000/tcp": "API REST (accesible en http://<homeassistant-ip>:3000)"

# Map configuration
map:
  - config:rw
  - ssl:ro

# Tmpfs for temporary files (better performance)
tmpfs: true

# Privileges
privileged: []
full_access: false
host_network: false

# Labels
labels:
  io.hass.type: addon
